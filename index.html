<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hamburguesa vs Papas Fritas</title>
    <style>
        /* Adaptación para pantallas de dispositivos móviles */
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #ffffff;
            overflow: hidden;
            height: 100vh;
        }

        #game-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        #canvas {
            width: 100%;
            height: calc(100vh - 120px); /* Espacio para controles */
            background-color: #ffffff;
        }

        /* Controles táctiles */
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 10px;
            width: 100%;
            box-sizing: border-box;
        }

        .button {
            width: 60px;
            height: 60px;
            background-color: #444;
            color: white;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            user-select: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="canvas"></canvas>
        <div class="controls">
            <div class="button" id="left">⬅️</div>
            <div class="button" id="up">⬆️</div>
            <div class="button" id="down">⬇️</div>
            <div class="button" id="right">➡️</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");

        // Ajustar el tamaño del canvas al tamaño de la pantalla disponible
        function ajustarCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - 120;  // Restamos el espacio para los controles
        }
        ajustarCanvas();
        window.addEventListener('resize', ajustarCanvas);

        class Hamburguesa {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 60;
                this.height = 40;
                this.imagen = new Image();
                this.imagen.src = 'hamburguesa.png';
            }

            dibujar() {
                ctx.drawImage(this.imagen, this.x, this.y, this.width, this.height);
            }

            mover(dx, dy, laberinto) {
                let nuevaX = this.x + dx;
                let nuevaY = this.y + dy;

                if (!this.colisionaConParedes(nuevaX, nuevaY, laberinto)) {
                    this.x = nuevaX;
                    this.y = nuevaY;
                }
            }

            colisionaCon(papa) {
                return (
                    this.x < papa.x + papa.width &&
                    this.x + this.width > papa.x &&
                    this.y < papa.y + papa.height &&
                    this.y + this.height > papa.y
                );
            }

            colisionaConPowerUp(powerup) {
                return (
                    this.x < powerup.x + powerup.width &&
                    this.x + this.width > powerup.x &&
                    this.y < powerup.y + powerup.height &&
                    this.y + this.height > powerup.y
                );
            }

            colisionaConParedes(nuevaX, nuevaY, laberinto) {
                for (const pared of laberinto) {
                    if (nuevaX < pared.x + pared.width &&
                        nuevaX + this.width > pared.x &&
                        nuevaY < pared.y + pared.height &&
                        nuevaY + this.height > pared.y) {
                        return true;
                    }
                }
                return false;
            }
        }

        class PapaFrita {
            constructor() {
                this.x = Math.random() * (canvas.width - 15);
                this.y = Math.random() * (canvas.height - 30);
                this.width = 15;
                this.height = 30;
                this.visible = true;
            }

            dibujar() {
                if (this.visible) {
                    ctx.fillStyle = "yellow";
                    ctx.fillRect(this.x, this.y, this.width, this.height);
                }
            }

            mover(hamburguesa) {
                if (this.visible) {
                    if (this.x < hamburguesa.x) this.x += 1;
                    else if (this.x > hamburguesa.x) this.x -= 1;

                    if (this.y < hamburguesa.y) this.y += 1;
                    else if (this.y > hamburguesa.y) this.y -= 1;
                }
            }
        }

        class PowerUp {
            constructor() {
                this.x = Math.random() * (canvas.width - 20) + 50;
                this.y = Math.random() * (canvas.height - 20) + 50;
                this.width = 20;
                this.height = 20;
                this.active = true;
            }

            dibujar() {
                if (this.active) {
                    ctx.fillStyle = "red";
                    ctx.fillRect(this.x, this.y, this.width, this.height);
                }
            }
        }

        class Rectangulo {
            constructor(x, y, width, height) {
                this.x = x;
                this.y = y;
                this.width = width;
                this.height = height;
            }
        }

        const hamburguesa = new Hamburguesa(canvas.width / 2 - 50, canvas.height / 2 - 30);
        const papas = Array.from({ length: 5 }, () => new PapaFrita());
        const powerup = new PowerUp();
        const laberinto = crearLaberinto();

        function crearLaberinto() {
            return [
                new Rectangulo(100, 100, 600, 20),
                new Rectangulo(100, 200, 20, 300),
                new Rectangulo(680, 100, 20, 300),
                new Rectangulo(300, 400, 200, 20),
                new Rectangulo(300, 200, 200, 20),
                new Rectangulo(300, 100, 100, 70)
            ];
        }

        let juegoActivo = true;

        function actualizar() {
            if (juegoActivo) {
                for (const papa of papas) {
                    papa.mover(hamburguesa);
                }

                for (const papa of papas) {
                    if (hamburguesa.colisionaCon(papa)) {
                        if (papa.visible) {
                            juegoActivo = false;
                            alert("¡Perdiste!");
                            document.location.reload();
                            break;
                        }
                    }
                }

                if (powerup.active && hamburguesa.colisionaConPowerUp(powerup)) {
                    powerup.active = false;
                    for (const papa of papas) {
                        papa.visible = false;
                    }
                    setTimeout(() => {
                        for (const papa of papas) {
                            papa.visible = true;
                        }
                    }, 3000);
                }
            }
        }

        function dibujar() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            hamburguesa.dibujar();
            for (const papa of papas) {
                papa.dibujar();
            }
            powerup.dibujar();
            dibujarLaberinto();
        }

        function dibujarLaberinto() {
            ctx.fillStyle = "blue";
            for (const pared of laberinto) {
                ctx.fillRect(pared.x, pared.y, pared.width, pared.height);
            }
        }

        function loop() {
            actualizar();
            dibujar();
            requestAnimationFrame(loop);
        }

        let touchInterval;
        function iniciarMovimiento(dx, dy) {
            touchInterval = setInterval(() => hamburguesa.mover(dx, dy, laberinto), 1000 / 60);
        }

        function detenerMovimiento() {
            clearInterval(touchInterval);
        }

        document.getElementById("left").addEventListener("touchstart", () => iniciarMovimiento(-5, 0));
        document.getElementById("right").addEventListener("touchstart", () => iniciarMovimiento(5, 0));
        document.getElementById("up").addEventListener("touchstart", () => iniciarMovimiento(0, -5));
        document.getElementById("down").addEventListener("touchstart", () => iniciarMovimiento(0, 5));

        document.getElementById("left").addEventListener("touchend", detenerMovimiento);
        document.getElementById("right").addEventListener("touchend", detenerMovimiento);
        document.getElementById("up").addEventListener("touchend", detenerMovimiento);
        document.getElementById("down").addEventListener("touchend", detenerMovimiento);

        loop();
    </script>
</body>
</html>
